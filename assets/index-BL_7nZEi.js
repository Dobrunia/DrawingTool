(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const F='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.6667 13.6667L18 10.3333L14.6667 7M18 10.3333H8.83333C7.94928 10.3333 7.10143 10.6845 6.47631 11.3096C5.85119 11.9348 5.5 12.7826 5.5 13.6667C5.5 14.5507 5.85119 15.3986 6.47631 16.0237C7.10143 16.6488 7.94928 17 8.83333 17H9.66667"/></svg>',S='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.33333 13.6667L6 10.3333L9.33333 7M6 10.3333H15.1667C16.0507 10.3333 16.8986 10.6845 17.5237 11.3096C18.1488 11.9348 18.5 12.7826 18.5 13.6667C18.5 14.5507 18.1488 15.3986 17.5237 16.0237C16.8986 16.6488 16.0507 17 15.1667 17H14.3333"/></svg>',k=document.getElementById("undo"),I=document.getElementById("redo"),l=document.getElementById("drawingCanvas"),i=l.getContext("2d"),q=document.querySelector(".brush-size"),P=document.getElementById("save"),E=document.querySelectorAll(".tool-btn"),b=document.querySelector("#color-selector"),C=document.querySelectorAll(".color-btn");let g=[],y=[],v=!1,m="brush",B="#FFFFFF",h=4,p=[];k.innerHTML=S;I.innerHTML=F;const d=document.createElement("div");d.style.position="absolute";d.style.borderRadius="50%";d.style.pointerEvents="none";d.style.zIndex="1000";d.style.border="2px solid rgba(255, 255, 255, 0.5)";d.style.display="none";document.body.appendChild(d);l.style.cursor="none";l.addEventListener("mouseenter",()=>{d.style.display="block"});l.addEventListener("mouseleave",()=>{d.style.display="none"});l.addEventListener("mousemove",e=>{const t=e.clientX-h/2,s=e.clientY-h/2;d.style.left=`${t}px`,d.style.top=`${s}px`});const f=new Image;f.src="1.png";f.onload=function(){l.width=f.width,l.height=f.height,i.drawImage(f,0,0,f.width,f.height),D()};E.forEach(e=>{e.addEventListener("click",function(){var t;E.forEach(s=>s.classList.remove("active")),e.classList.add("active"),m=((t=e.textContent)==null?void 0:t.toLowerCase())||"brush",m==="blur"?b.style.display="none":b.style.display="flex"})});C.forEach(e=>{e.addEventListener("click",function(){C.forEach(t=>t.classList.remove("active")),e.classList.add("active"),B=window.getComputedStyle(e).backgroundColor})});q.addEventListener("input",function(){h=Number(this.value),d.style.width=`${h}px`,d.style.height=`${h}px`});l.addEventListener("mousedown",R);l.addEventListener("mouseup",T);l.addEventListener("mousemove",H);l.addEventListener("mouseleave",T);function R(e){v=!0,p=[];const t=e.clientX-l.offsetLeft,s=e.clientY-l.offsetTop;p.push({x:t,y:s}),i.beginPath(),i.moveTo(t,s)}function T(){if(v){if(v=!1,i.closePath(),m==="brush"){const e=L(p,2);$(e)}D()}}function H(e){if(!v)return;const t=e.clientX-l.offsetLeft,s=e.clientY-l.offsetTop;if(i.lineWidth=h,i.lineCap="round",m==="brush")i.strokeStyle=B,i.lineTo(t,s),i.stroke(),i.moveTo(t,s),p.push({x:t,y:s});else if(m==="blur"){const r=h/2,o=r*2,n=i.getImageData(t-r,s-r,o,o);O(n),i.putImageData(n,t-r,s-r)}}function O(e){const t=e.data,s=e.width,r=e.height;for(let o=0;o<r;o++)for(let n=0;n<s;n++){const c=(o*s+n)*4,a=z(t,s,r,n,o),u=N(a);t[c]=u[0],t[c+1]=u[1],t[c+2]=u[2]}}function z(e,t,s,r,o){const n=[];for(let c=-1;c<=1;c++)for(let a=-1;a<=1;a++){const u=r+a,w=o+c;if(u>=0&&u<t&&w>=0&&w<s){const x=(w*t+u)*4;n.push([e[x],e[x+1],e[x+2]])}}return n}function N(e){const t=[0,0,0];e.forEach(r=>{t[0]+=r[0],t[1]+=r[1],t[2]+=r[2]});const s=e.length;return[t[0]/s,t[1]/s,t[2]/s]}function L(e,t){if(e.length<3)return e;let s=0,r=0;const o=e.length-1;for(let n=1;n<o;n++){const c=U(e[n],e[0],e[o]);c>s&&(r=n,s=c)}if(s>t){const n=L(e.slice(0,r+1),t),c=L(e.slice(r),t);return[...n.slice(0,n.length-1),...c]}else return[e[0],e[o]]}function U(e,t,s){const r=s.x-t.x,o=s.y-t.y,n=Math.sqrt(r*r+o*o),c=((e.x-t.x)*r+(e.y-t.y)*o)/(n*n),a={x:t.x+c*r,y:t.y+c*o};return Math.sqrt((e.x-a.x)**2+(e.y-a.y)**2)}function $(e){i.beginPath(),i.moveTo(e[0].x,e[0].y);for(let t=1;t<e.length;t++)i.lineTo(e[t].x,e[t].y);i.stroke()}k.addEventListener("click",A);I.addEventListener("click",X);function D(){y=[],g.push(l.toDataURL())}function A(){if(g.length>0){y.push(g.pop());const e=g[g.length-1]||f.src;M(e)}}function X(){if(y.length>0){const e=y.pop();g.push(e),M(e)}}function M(e){const t=new Image;t.src=e,t.onload=()=>{i.clearRect(0,0,l.width,l.height),i.drawImage(t,0,0)}}P.addEventListener("click",()=>{const e=document.createElement("a");e.download="canvas-image.png",e.href=l.toDataURL(),e.click()});
